# Game of Thrones isAlive

Репозиторий посвящен работе с датасетом о персонажах из вселенной "Игры Престолов". Задача проекта - предсказание, кто из персонажей умрет, а кто останется в живых.

Это было одним из домашних заданий в рамках курса [Deep Learning School от МФТИ](https://stepik.org/course/250969/syllabus). Помимо основного задания я решил изучить библиотеки градиентного бустинга (XGBoost, CatBoost)

## Задача

Задача состояла в том, чтобы решить задачу классификации, а именно задачу предсказания выживет ли персонаж из Игры Престолов или нет. Результат оценивался по метрике Accuracy.

## Описание решения задачи

### Этап 1: Анализ и предобработка данных

Данные для тренировки модели были взяты из файла `game_of_thrones_train.csv`.

**Предобработка данных включала в себя:**
- Обработку пропущенных данных
- Создание новых признаков
- Удаление ненужных столбцов

**Анализ данных включал в себя:**
- Анализ целевой переменной
- Анализ признаков
- Анализ влияния признаков на целевую переменную

Подробно о том, какими методами проводились предобработка и анализ данных написано в рабочих ноутбуках `hw_1_game_of_thrones.ipynb` и `hw_1_game_of_thrones_BOOSTED.ipynb`

Затем данные были разделены на тренировочную (train) и валидационную (val) выборки в соотношении 0.75/0.25. Так как у целевой переменной наблюдался явно выраженный дисбаланс классов, то при разбиении на тренировочную и валидационную выборки применялась стратификация.

### Этап 2: Обучение моделей

На втором этапе были обучены следующие модели:
- LogisticRegression
- RandomForestClassifier
- SVC
- GaussianNB

Из-за наличия интереса, я вышел немного за рамки задания и добавил ещё модель градиентного бустинга (XGBoost)

Для всех вышеуказанных моделей была задана сетка гиперпараметров и с использованием GridSearchCV были получены модели с наилучшими гиперпараметрами.

### Этап 3: Оценка качества моделей

На третьем этапе была проведена оценка качества вышеуказанных моделей. Оценка проводилась на валидационной выборке, метрика качества моделей accuracy.

**Результаты на валидационной выборке:**
- LogisticRegression Accuracy: 0.7923
- RandomForestClassifier Accuracy: 0.8026
- SVC Accuracy: 0.7872
- GaussianNB Accuracy: 0.7385
- XGBClassifier Accuracy: 0.8026

Затем на основе данных из файла `game_of_thrones_test.csv` (данные были обработаны таким же образом как данные из `game_of_thrones_train.csv`) были предсказано выживет ли персонаж или нет.

Результат работы модели логистической регрессии был сохранен в файл `new_submission.csv`.

Несмотря на то, что на валидационной выборке RandomForestClassifier имеет accuracy выше, чем LogisticRegression, при проверке на неизвестной тестовой выборке (сабмитилось на степик) LogisticRegression показала себя немного лучше.

**Результаты на тестовой выборке:**
- LogisticRegression: 0.6529562982005142
- RandomForestClassifier: 0.6426735218508998
- XGBoost: 0.7249357326478149

Результат предсказаний XGBoost записан в файл `XGB_submission.csv`.

### Вне задачи

Пока разбирался с XGBoost узнал, что есть библиотека CatBoost, которая сама обрабатывает категориальные признаки. Мне стало интересно, как она будет работать на данных без feature engineering.

Поэтому последним этапом я использовал модель catboost на голом тренировочном датасете. Единственная предобработка, которая выполнялась - это выделение категориальных признаков и замена NaN'ов на Unknown (так необходимо для catboost).

**Результаты CatBoost:**
- Валидационная выборка: accuracy 0.8102564102564103
- Тестовая выборка: accuracy 0.7300771208226221

## Описание загруженных файлов

- `hw_1_game_of_thrones.ipynb` - изначальный notebook, который посвящен решению домашнего задания
- `hw_1_game_of_thrones_BOOSTED.ipynb` - notebook, в который добавлены части с XGBoost и CatBoost
- `game_of_thrones_train.csv` и `game_of_thrones_test.csv` - тренировочные и тестовые данные, соответственно
- `new_submission.csv` - предсказания модели LogisticRegression
- `XGB_submission.csv` - предсказания модели XGBClassifier
- `catboost_submission.csv` - предсказания модели CatBoostClassifier

## Необходимые библиотеки

- [pandas](https://pandas.pydata.org/)
- [matplotlib](https://matplotlib.org/)
- [seaborn](https://seaborn.pydata.org/)
- [numpy](https://numpy.org/)
- [scikit-learn](https://scikit-learn.org/)
- [XGBoost](https://xgboost.readthedocs.io/)
- [CatBoost](https://catboost.ai/)

## Описание данных

**Основные признаки:**
- `name`: Имя персонажа
- `Title`: Социальный статус или знатность
- `House`: Дом, к которому принадлежит персонаж
- `Culture`: Социальная группа, к которой принадлежит персонаж
- `book1/2/3/4/5`: Появление персонажа в книге
- `Is noble`: Знатность персонажа, основанное на титуле
- `Age`: Отсчет времени: 305 AC
- `male`: Мужчина или женщина
- `dateOfBirth`: дата рождения

**Семейные отношения:**
- `Spouse`: Имя супруги/а персонажа
- `Father`: Имя отца персонажа
- `Mother`: Имя матери персонажа
- `Heir`: Имя наследника персонажа
- `Is married`: Наличие супруга
- `Is spouse alive`: Жив ли супруг
- `Is mother alive`: Жива ли мать персонажа
- `Is heir alive`: Жив ли наследник
- `Is father alive`: Указывает, жив ли отец персонажа

**Дополнительные признаки:**
- `Number dead relations`: Количество умерших персонажей, с которыми персонаж связан
- `Popularity score`: Количество внутренних входящих и исходящих ссылок на страницу персонажей в вики http://awoiaf.westeros.org

**Целевая переменная:**
- `isAlive`: жив ли персонаж в книге
